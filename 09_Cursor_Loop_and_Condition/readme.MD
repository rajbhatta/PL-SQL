# Data definition language for test #
```sql
----===================== SCRIPT TO CREATE EMPLOYEES TABLE =================
CREATE TABLE RAJ.EMPLOYEES
(
  EMPLOYEE_ID     NUMBER(6),
  FIRST_NAME      VARCHAR2(20 BYTE),
  LAST_NAME       VARCHAR2(25 BYTE) NOT NULL,
  EMAIL           VARCHAR2(25 BYTE) NOT NULL,
  PHONE_NUMBER    VARCHAR2(20 BYTE),
  HIRE_DATE       DATE NOT NULL,
  JOB_ID          VARCHAR2(10 BYTE)NOT NULL,
  SALARY          NUMBER(8,2),
  COMMISSION_PCT  NUMBER(2,2),
  MANAGER_ID      NUMBER(6),
  DEPARTMENT_ID   NUMBER(4)
);


----===================== SCRIPT TO CREATE HISTORY TABLE =================
CREATE TABLE RAJ.JOB_HISTORY
(
  EMPLOYEE_ID    NUMBER(6)  NOT NULL,
  START_DATE     DATE NOT NULL,
  END_DATE       DATE  NOT NULL,
  JOB_ID         VARCHAR2(10 BYTE) NOT NULL,
  DEPARTMENT_ID  NUMBER(4)
)
```
# Cusor and loop #
```sql
DECLARE
  CURSOR EMPLOYEE_CURSOR IS
     SELECT EMPLOYEE_ID, SALARY, COMMISSION_PCT, COUNT(START_DATE) JOBCOUNT
     FROM EMPLOYEES LEFT OUTER JOIN JOB_HISTORY JH
     USING(EMPLOYEE_ID)
     GROUP BY EMPLOYEE_ID,SALARY,COMMISSION_PCT
     ORDER BY 1;
   V_BONUS NUMBER(5);
BEGIN
  FOR  EMPLOYEE_RECORD IN EMPLOYEE_CURSOR
  LOOP
     IF EMPLOYEE_RECORD.JOBCOUNT > 0 THEN
        V_BONUS := EMPLOYEE_RECORD.SALARY * 0.40;
     ELSIF EMPLOYEE_RECORD.COMMISSION_PCT IS NOT NULL THEN
        V_BONUS := EMPLOYEE_RECORD.SALARY * 0.25;
     ELSE
        V_BONUS := EMPLOYEE_RECORD.SALARY * 0.35;
     END IF;
     
     DBMS_OUTPUT.PUT_LINE(EMPLOYEE_RECORD.EMPLOYEE_ID || ' - ' || V_BONUS);
  END LOOP;     
END;
```

